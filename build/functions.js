(()=>{"use strict";let t=new Map,e=!1;async function o(){e=!1;const o=new Map(t);t.clear();const a=Array.from(o.entries()).sort(((t,e)=>t[0].getTime()-e[0].getTime())),n=new Map;let r=null,s=[];for(let t=0;t<a.length;t++){const[e,o]=a[t];if(null==r&&(r=e),s.push(o),e-r>31536e6||t==a.length-1){const t=`http://localhost:38820/https://api.aeso.ca/report/v1.1/price/poolPrice?startDate=${r.getUTCFullYear().toFixed()}-${(r.getUTCMonth()+1).toFixed().padStart(2,"0")}-${(r.getUTCDate()+1).toFixed().padStart(2,"0")}&endDate=${e.getUTCFullYear().toFixed()}-${(e.getUTCMonth()+1).toFixed().padStart(2,"0")}-${(e.getUTCDate()+1).toFixed().padStart(2,"0")}`;n.set(t,s),r=null,s=[]}}const i=[];for(const[t,e]of n)i.push(new Promise((async(o,a)=>{try{const o=await fetch(t,{headers:{"X-API-Key":localStorage.getItem("aeso-api-key")}}),a=await o.json();for(const t of e)t.resolve(a)}catch(t){for(const o of e)o.reject(t)}})));await Promise.allSettled(i)}CustomFunctions.associate("AESOPOOLPRICE",(async function(a,n){console.log(localStorage.getItem("aeso-api-key"));const r=function(t){switch(typeof t){case"string":{const e=new Date(t);if(isNaN(e.getTime()))throw new Error(`Invalid date "${t}".`);return new Date(t)}case"number":return(e=t)<61||(e-=1),new Date(24*(e-25568)*3600*1e3)}var e}(a),s=await function(a){const n={resolve:void 0,reject:void 0},r=new Promise(((t,e)=>{n.resolve=t,n.reject=e})),s=t.get(a);return s?s.push(n):t.set(a,[n]),_isBatchedRequestScheduled||(e=!0,setTimeout(o,100)),r}(r),i=`${r.getUTCFullYear()}-${(r.getUTCMonth()+1).toString().padStart(2,"0")}-${(r.getUTCDate()+1).toString().padStart(2,"0")} ${n.toString().padStart(2,"0")}:00`;for(const t of s.return["Pool Price Report"])if(t.begin_datetime_mpt==i)return t.pool_price;return results})),CustomFunctions.associate("XLDATETOJSDATE",(function(t){return dateFromSerial(t).toString()})),CustomFunctions.associate("CREATEFORMATTEDNUMBER",(function(t,e){return{type:"FormattedNumber",basicValue:t,numberFormat:e}})),CustomFunctions.associate("LOGINPUT",(function(t){console.log(typeof t+":",t)}))})();